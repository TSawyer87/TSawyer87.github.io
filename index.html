<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.148.2"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NixOS Blog</title><meta name=description content><meta name=author content><link rel=canonical href=https://tsawyer87.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://tsawyer87.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tsawyer87.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tsawyer87.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tsawyer87.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tsawyer87.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://tsawyer87.github.io/index.xml><link rel=alternate type=application/json href=https://tsawyer87.github.io/index.json><link rel=alternate type=application/json href=https://tsawyer87.github.io/searchindex.json><link rel=alternate hreflang=en href=https://tsawyer87.github.io/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://tsawyer87.github.io/"><meta property="og:site_name" content="NixOS Blog"><meta property="og:title" content="NixOS Blog"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="NixOS Blog"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"NixOS Blog","url":"https://tsawyer87.github.io/","description":"","logo":"https://tsawyer87.github.io/favicon.ico","sameAs":[]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tsawyer87.github.io/ accesskey=h title="NixOS Blog (Alt + H)">NixOS Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
<a href=/index.xml title="RSS Feed"><img src=/rss.png alt="RSS Feed" style=width:24px;height:24px></a></div></div><ul id=menu></ul></nav></header><main class=main><article class=first-entry><header class=entry-header><h2 class=entry-hint-parent>Hardening_networking</h2></header><div class=entry-content><p>Hardening Networking ⚠️ While I am not a security expert, I have carefully researched and tested the configurations in this chapter. The advice presented here is grounded in widely accepted best practices and is generally safe and effective.
However, since networks and systems vary, some adjustments may cause unexpected issues, especially around critical components like DNS or firewalls. Always review and test changes in a controlled environment before applying them broadly.
...</p></div><footer class=entry-footer><span title='2025-08-14 08:21:11 -0400 EDT'>August 14, 2025</span></footer><a class=entry-link aria-label="post link to Hardening_networking" href=https://tsawyer87.github.io/posts/hardening_networking/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Hardening_NixOS</h2></header><div class=entry-content><p>Hardening NixOS Securing your NixOS system begins with a philosophy of minimalism, explicit configuration, and proactive control.
⚠️ Warning: I am not a security expert. This guide presents various options for hardening NixOS, but it is your responsibility to evaluate whether each adjustment suits your specific needs and environment. Security hardening and process isolation can introduce stability challenges, compatibility issues, or unexpected behavior. Additionally, these protections often come with performance tradeoffs. Always conduct thorough research, there are no plug and play one size fits all security solutions.
...</p></div><footer class=entry-footer><span title='2025-08-10 08:37:54 -0400 EDT'>August 10, 2025</span></footer><a class=entry-link aria-label="post link to Hardening_NixOS" href=https://tsawyer87.github.io/posts/hardening_nixos/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Fork_clone_contribute</h2></header><div class=entry-content><p>Fork, Clone, Contribute In the Nixpkgs Repository.
Click Fork, then Create a new Fork.
Uncheck the box “Only fork the master branch”, for development we will need more branches for development.
If you only fork master, you won’t have the nixos-XX.YY release branches available on your fork when you later try to create a PR against them, or when you want to create a feature branch from them on your fork. Click &lt;> Code and Clone the Repo. saylesss88 is the name of my GitHub, yours will obviously be different.
...</p></div><footer class=entry-footer><span title='2025-06-15 18:24:27 -0400 EDT'>June 15, 2025</span></footer><a class=entry-link aria-label="post link to Fork_clone_contribute" href=https://tsawyer87.github.io/posts/fork_clone_contribute/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Nix_paths</h2></header><div class=entry-content><p>Nix Paths The following examples are done with a local nixpkgs clone located at ~/src/nixpkgs
Paths in Nix always need a / in them and always expand to absolute paths relative to your current directory.
nix repl nix-repl> ./. /home/jr/src/nixpkgs nix-repl> ./. + "/lib" /home/jr/src/nixpkgs/lib Nix does path normalization every time you append strings, so if you just add a slash / its not actually there:
nix-repl> ./. /home/jr/src/nixpkgs nix-repl> ./. + "/" /home/jr/src/nixpkgs nix-repl> ./. + "/" + "lib" /home/jr/src/nixpkgslib nix-repl> "${./.}/lib" # using ${./.} causes a store copy copying '/homr/jr/src/nixpkgs' to the store "/nix/store/3z9fzx8z03wslxvri5syv3jnnhn5fkbd-nixpkgs/lib" nix-repl> "${toString ./.}/lib" # using toString avoids making a store copy "/home/jr/src/nixpkgs/lib" nix-repl> ./lib/.. # nix removes all `..` to avoid redundant path resolutions /home/jr/src/nixpkgs nix-repl> :q realpath ./lib/.. /home/jr/src/nixpkgs ln -s pkgs/applications lib-symlink realpath ./lib-symlink/.. /home/jr/src/nixpkgs/pkgs nix repl nix-repl> ./lib-symlink/.. # Nix doesn't read this file at all like realpath did /home/jr/src/nixpkgs nix-repl> builtins.readDir ./. # listing of all entries in current dir and their types { ".devcontainer" = "directory"; ".editorconfig" = "regular"; ".git" = "directory"; ".git-blame-ignore-revs" = "regular"; ".gitattributes" = "regular"; ".github" = "directory"; ".gitignore" = "regular"; ".mailmap" = "regular"; ".mergify.yml" = "regular"; ".version" = "symlink"; "CONTRIBUTING.md" = "regular"; COPYING = "regular"; "README.md" = "regular"; ci = "directory"; "default.nix" = "regular"; doc = "directory"; "flake.nix" = "regular"; lib = "directory"; maintainers = "directory"; nixos = "directory"; pkgs = "directory"; "shell.nix" = "regular"; } nix-repl> builtins.readFile ./default.nix "let\n requiredVersion = import ./lib/minver.nix;\nin\n\nif !builtins ? nixVersion || builtins.compareVersions requiredVersion builtins.nixVersion == 1 then\n\n abort ''\n\n This version of Nixpkgs requires Nix >= \${requiredVersion}, please upgrade:\n\n - If you are running NixOS, `nixos-rebuild' can be used to upgrade your system.\n\n - Alternatively, with Nix > 2.0 `nix upgrade-nix' can be used to imperatively\n upgrade Nix. You may use `nix-env --version' to check which version you have.\n\n - If you installed Nix using the install script (https://nixos.org/nix/install),\n it is safe to upgrade by running it again:\n\n curl -L https://nixos.org/nix/install | sh\n\n For more information, please see the NixOS release notes at\n https://nixos.org/nixos/manual or locally at\n \${toString ./nixos/doc/manual/release-notes}.\n\n If you need further help, see https://nixos.org/nixos/support.html\n ''\n\nelse\n\n import ./pkgs/top-level/impure.nix\n" nix-repl> :l &lt;nixpkgs/lib> nix-repl> importJSON ./pkgs/development/python-modules/notebook/missing-hashes.json # Return the nix value for JSON { "@nx/nx-darwin-arm64@npm:16.10.0" = "aabcc8499602b98c9fc3b768fe46dfd4e1b818caa84b740bd4f73a2e4528c719b979ecb1c10a0d793a1fead83073a08bc86417588046aa3e587e80af880bffd3"; "@nx/nx-darwin-x64@npm:16.10.0" = "9dd20f45f646d05306f23f5abb7ade69dcb962e23a013101e93365847722079656d30a19c735fdcfa5c4e0fdf08691f9d621073c58aef2861c26741ff4638375"; "@nx/nx-freebsd-x64@npm:16.10.0" = "35b93aabe3b3274d53157a6fc10fec7e341e75e6818e96cfbc89c3d5b955d225ca80a173630b6aa43c448c6b53b23f06a2699a25c0c8bc71396ee20a023d035f"; "@nx/nx-linux-arm-gnueabihf@npm:16.10.0" = "697b9fa4c70f84d3ea8fe32d47635864f2e40b0ceeb1484126598c61851a2ec34b56bb3eeb9654c37d9b14e81ce85a36ac38946b4b90ca403c57fe448be51ccb"; "@nx/nx-linux-arm64-gnu@npm:16.10.0" = "001e71fedfc763a4dedd6c5901b66a4a790d388673fb74675235e19bb8fe031ff3755568ed867513dd003f873901fabda31a7d5628b39095535cb9f6d1dc7191"; "@nx/nx-linux-arm64-musl@npm:16.10.0" = "58e3b71571bdadd2b0ddd24ea6e30cd795e706ada69f685403412c518fba1a2011ac8c2ac46145eab14649aa5a78e0cedcdb4d327ccb3b6ec12e055171f3840b"; "@nx/nx-linux-x64-gnu@npm:16.10.0" = "97729a7efb27301a67ebf34739784114528ddb54047e63ca110a985eaa0763c5b1ea7c623ead1a2266d07107951be81e82ffa0a30e6e4d97506659303f2c8c78"; "@nx/nx-linux-x64-musl@npm:16.10.0" = "442bdbd5e61324a850e4e7bd6f54204108580299d3c7c4ebcec324da9a63e23f48d797a87593400fc32af78a3a03a3c104bfb360f107fe732e6a6c289863853a"; "@nx/nx-win32-arm64-msvc@npm:16.10.0" = "b5c74184ebfc70294e85f8e309f81c3d40b5cf99068891e613f3bef5ddb946bef7c9942d9e6c7688e22006d45d786342359af3b4fc87aadf369afcda55c73187"; "@nx/nx-win32-x64-msvc@npm:16.10.0" = "c5b174ebd7a5916246088e17d3761804b88f010b6b3f930034fa49af00da33b6d1352728c733024f736e4c2287def75bafdc3d60d8738bd24b67e9a4f11763f8"; } nix-repl> builtins.toJSON # serialize «primop toJSON» nix-repl> builtins.fromTOML «primop fromTOML» nix-repl> builtins.toXML For more serialization formats see nixpkgs/lib/generators.nix as well as in nixpkgs/pkgs/pkgs-lib/formats/ we can see them with the nix repl as follows:
...</p></div><footer class=entry-footer><span title='2025-06-15 18:21:05 -0400 EDT'>June 15, 2025</span></footer><a class=entry-link aria-label="post link to Nix_paths" href=https://tsawyer87.github.io/posts/nix_paths/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Btrfs_impermanence</h2></header><div class=entry-content><p>Unencrypted BTRFS Impermanence with Flakes Figure 1: Impermanence Logo: Image of the Impermanence logo. Sourced from the
This guide is for an unencrypted setup, there are a few links at the end for encrypted setups. This guide follows the previous minimal install guide but you should be able to adjust it carefully to meet your needs.
This section details how to set up impermanence on your NixOS system using BTRFS subvolumes. With impermanence, your operating system’s root filesystem will reset to a pristine state on each reboot, while designated directories and files remain persistent. This provides a highly reliable and rollback-friendly system.
...</p></div><footer class=entry-footer><span title='2025-06-15 18:15:13 -0400 EDT'>June 15, 2025</span></footer><a class=entry-link aria-label="post link to Btrfs_impermanence" href=https://tsawyer87.github.io/posts/btrfs_impermanence/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Minimal_btrfs_subvolume_install_disko</h2></header><div class=entry-content><p>Minimal BTRFS-Subvol Install with Disko and Flakes Why I Chose BTRFS I chose BTRFS because I was already familiar with it from using it with Arch Linux and I found it to be very easy to use. From what I’ve read, there are licensing issues between the Linux Kernel and ZFS which means that ZFS is not part of the Linux Kernel; it’s maintained by the OpenZFS project and available as a separate kernel module. This can cause issues and make you think more about your filesystem than I personally want to at this point.
...</p></div><footer class=entry-footer><span title='2025-06-15 18:14:54 -0400 EDT'>June 15, 2025</span></footer><a class=entry-link aria-label="post link to Minimal_btrfs_subvolume_install_disko" href=https://tsawyer87.github.io/posts/minimal_btrfs_subvolume_install_disko/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>hacking_the_helix_flake</h2></header><div class=entry-content><p>Chapter 4.4 Understanding the Helix Flake and Modifying its Behavior Understanding the Helix flake.nix Top-Level Metadata Inputs Outputs Function Common Setup - Breaking Down helix/default.nix - Making Actual Changes - Another way to Modify Behavior Understanding the Helix Flake and Modifying its Behavior As we’ve seen from previous examples, the helix editor repository includes a few .nix files including a flake.nix. Their flake uses a lot of idiomatic Nix code and advanced features. First I will break down their flake.nix and default.nix to understand why they do certain things. And finally, we will change the build to “debug” mode demonstrating how easily you can modify the behavior of a package defined within a Nix flake without changing the original source code or the upstream flake directly.
...</p></div><footer class=entry-footer><span title='2025-05-30 19:23:32 -0400 EDT'>May 30, 2025</span>&nbsp;·&nbsp;T Sawyer</footer><a class=entry-link aria-label="post link to hacking_the_helix_flake" href=https://tsawyer87.github.io/posts/hacking_the_helix_flake/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Using_nushell_with_nixos</h2></header><div class=entry-content><p>Nushell and NixOS TL;DR:I recently switched default shells from zsh to nushell, this post is about some of the challenges and advantages of using nushell with NixOS.
While the average user might not immediately see significant advantages, those who frequently work with structured data formats like JSON, YAML, and CSV – such as developers interacting with APIs, system administrators managing configurations, and data professionals – will likely find Nushell’s native data handling and powerful pipeline capabilities a plus. Additionally, users who value a more consistent and safer scripting experience might appreciate Nushell’s language-first design and features like strong typing.
...</p></div><footer class=entry-footer><span title='2025-05-16 19:54:01 -0400 EDT'>May 16, 2025</span></footer><a class=entry-link aria-label="post link to Using_nushell_with_nixos" href=https://tsawyer87.github.io/posts/using_nushell_with_nixos/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Nixpkgs_pull_requests</h2></header><div class=entry-content><p>Nixpkgs Pull Requests Pull requests communicate changes to a branch in a repository. Once a pull request is opened, you can review changes with collaborators and add follow-up commits.
A pull request is a proposal to merge a set of changes from one branch into another. In a pull request, collaborators can review and discuss the proposed set of changes before they integrate the changes into the main codebase.
Pull requests display the differences, or diffs, between the content in the source branch and the content in the target branch.
...</p></div><footer class=entry-footer><span title='2025-05-15 13:02:06 -0400 EDT'>May 15, 2025</span></footer><a class=entry-link aria-label="post link to Nixpkgs_pull_requests" href=https://tsawyer87.github.io/posts/nixpkgs_pull_requests/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Debugging_and_tracing_modules</h2></header><div class=entry-content><p>Debugging and Tracing NixOS Modules Other related post if you haven’t read my previous post on modules, that may be helpful before reading this one:
nix-modules-explained
This post is my notes following Nix Hour 40. If it seems a little chaotic, try watching one. They are hard to follow if you’re not extremely familiar with the concepts.
Nix Hour 40
Nix Code is particularly hard to debug because of (e.g. lazy evaluation, declarative nature, layered modules)
...</p></div><footer class=entry-footer><span title='2025-05-15 10:08:17 -0400 EDT'>May 15, 2025</span></footer><a class=entry-link aria-label="post link to Debugging_and_tracing_modules" href=https://tsawyer87.github.io/posts/debugging_and_tracing_modules/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://tsawyer87.github.io/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://tsawyer87.github.io/>NixOS Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>