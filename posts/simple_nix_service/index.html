<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Simple_nix_service | NixOS Blog</title><meta name=keywords content><meta name=description content="Building a Custom NixOS Service with Flakes and Overlays

     


TL;DR NixOS&rsquo;s declarative configuration and flakes make it easy to create
custom services. This post shows how to build a minimal service using flakes
and overlays for a &ldquo;meow&rdquo; command

This will be a complete minimal configuration for testing purposes.

Create Project Directory
Start by creating a directory to hold your project, I called mine meow:
mkdir meow && cd meow
Create flake
Create a flake.nix with the following:"><meta name=author content="T Sawyer"><link rel=canonical href=https://tsawyer87.github.io/posts/simple_nix_service/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://tsawyer87.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tsawyer87.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tsawyer87.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tsawyer87.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tsawyer87.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tsawyer87.github.io/posts/simple_nix_service/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://tsawyer87.github.io/posts/simple_nix_service/"><meta property="og:site_name" content="NixOS Blog"><meta property="og:title" content="Simple_nix_service"><meta property="og:description" content="Building a Custom NixOS Service with Flakes and Overlays TL;DR NixOS’s declarative configuration and flakes make it easy to create custom services. This post shows how to build a minimal service using flakes and overlays for a “meow” command
This will be a complete minimal configuration for testing purposes. Create Project Directory Start by creating a directory to hold your project, I called mine meow:
mkdir meow && cd meow Create flake Create a flake.nix with the following:"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-14T19:25:11-04:00"><meta property="article:modified_time" content="2025-05-14T19:25:11-04:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Simple_nix_service"><meta name=twitter:description content="Building a Custom NixOS Service with Flakes and Overlays

     


TL;DR NixOS&rsquo;s declarative configuration and flakes make it easy to create
custom services. This post shows how to build a minimal service using flakes
and overlays for a &ldquo;meow&rdquo; command

This will be a complete minimal configuration for testing purposes.

Create Project Directory
Start by creating a directory to hold your project, I called mine meow:
mkdir meow && cd meow
Create flake
Create a flake.nix with the following:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tsawyer87.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Simple_nix_service","item":"https://tsawyer87.github.io/posts/simple_nix_service/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Simple_nix_service","name":"Simple_nix_service","description":"Building a Custom NixOS Service with Flakes and Overlays TL;DR NixOS\u0026rsquo;s declarative configuration and flakes make it easy to create custom services. This post shows how to build a minimal service using flakes and overlays for a \u0026ldquo;meow\u0026rdquo; command\nThis will be a complete minimal configuration for testing purposes. Create Project Directory Start by creating a directory to hold your project, I called mine meow:\nmkdir meow \u0026amp;\u0026amp; cd meow Create flake Create a flake.nix with the following:\n","keywords":[],"articleBody":"Building a Custom NixOS Service with Flakes and Overlays TL;DR NixOS’s declarative configuration and flakes make it easy to create custom services. This post shows how to build a minimal service using flakes and overlays for a “meow” command\nThis will be a complete minimal configuration for testing purposes. Create Project Directory Start by creating a directory to hold your project, I called mine meow:\nmkdir meow \u0026\u0026 cd meow Create flake Create a flake.nix with the following:\n# flake.nix { inputs.nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\"; outputs = { self, nixpkgs, ... }: { overlays.default = final: prev: { meow = final.writeShellScriptBin \"meow\" '' echo meow ''; }; nixosModules.default = { pkgs, config, lib, ... }: { imports = [ ./nixos-module.nix ]; # inject dependencies from flake.nix, and don't do anything else config = lib.mkIf config.services.meow.enable { nixpkgs.overlays = [ self.overlays.default ]; services.meow.package = lib.mkDefault pkgs.meow; }; }; }; } Create Service Module Next we’ll create the nixos-module.nix in the same directory with the following content:\n# nixos-module.nix { pkgs, config, lib, ... }: let cfg = config.services.meow; in { options = { services.meow = { enable = lib.mkEnableOption \"meow\"; package = lib.mkOption { description = \"meow package to use\"; type = lib.types.package; }; }; }; config = lib.mkIf cfg.enable { systemd.services.meow = { description = \"meow at the user on the console\"; serviceConfig = { Type = \"oneshot\"; ExecStart = \"${cfg.package}/bin/meow\"; StandardOutput = \"journal+console\"; }; wantedBy = [ \"multi-user.target\" ]; }; }; } Add nixosConfigurations Output Lastly, we will add a nixosConfigurations output to the flake.nix\n# flake.nix nixosConfigurations.test = nixpkgs.lib.nixosSystem { system = \"x86_64-linux\"; modules = [ self.nixosModules.default ({ pkgs, lib, ... }: { fileSystems.\"/\" = { device = \"/dev/sda1\"; }; boot.loader.grub.enable = false; boot.initrd.enable = false; boot.kernel.enable = false; documentation.enable = false; services.meow.enable = true; system.stateVersion = \"25.05\"; }) ]; }; nixosConfigurations.test is simply the name we chose for this particular NixOS system configuration. The final product will look like this:\n# flake.nix { inputs.nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\"; outputs = { self, nixpkgs, ... }: { overlays.default = final: prev: { meow = final.writeShellScriptBin \"meow\" '' echo meow ''; }; nixosModules.default = { pkgs, config, lib, ... }: { imports = [./nixos-module.nix]; # inject dependencies from flake.nix, and don't do anything else config = lib.mkIf config.services.meow.enable { nixpkgs.overlays = [self.overlays.default]; services.meow.package = lib.mkDefault pkgs.meow; }; }; nixosConfigurations.test = nixpkgs.lib.nixosSystem { system = \"x86_64-linux\"; modules = [ self.nixosModules.default ({ pkgs, lib, ... }: { fileSystems.\"/\" = { device = \"/dev/sda1\"; }; boot.loader.grub.enable = false; boot.initrd.enable = false; boot.kernel.enable = false; documentation.enable = false; services.meow.enable = true; system.stateVersion = \"25.05\"; }) ]; }; }; } Build the System Configuration Then build the system configuration:\nnix build .#nixosConfigurations.test.config.system.build.toplevel\nIf this builds successfully you’ll see a result directory within your meow directory.\nI wouldn’t recommend actually switching to this configuration but you could build it to gain familiarity with it. If you were to switch to it you would run ./result/bin/switch-to-configuration\nTest in a NixOS Virtual Machine (Recommended):The safest way to see the “meow” output is to build the configuration and then run it in a NixOS virtual machine. You can do this using tools like nixos-generate-config and a virtualization tool (like VirtualBox, QEMU, or GNOME Boxes).\n","wordCount":"533","inLanguage":"en","datePublished":"2025-05-14T19:25:11-04:00","dateModified":"2025-05-14T19:25:11-04:00","author":{"@type":"Person","name":"T Sawyer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tsawyer87.github.io/posts/simple_nix_service/"},"publisher":{"@type":"Organization","name":"NixOS Blog","logo":{"@type":"ImageObject","url":"https://tsawyer87.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tsawyer87.github.io/ accesskey=h title="NixOS Blog (Alt + H)">NixOS Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
<a href=/index.xml title="RSS Feed"><img src=/images/rss.png alt="RSS Feed" style=width:24px;height:24px></a></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Simple_nix_service</h1><div class=post-meta><span title='2025-05-14 19:25:11 -0400 EDT'>May 14, 2025</span>&nbsp;·&nbsp;T Sawyer</div></header><div class=post-content><h1 id=building-a-custom-nixos-service-with-flakes-and-overlays>Building a Custom NixOS Service with Flakes and Overlays<a hidden class=anchor aria-hidden=true href=#building-a-custom-nixos-service-with-flakes-and-overlays>#</a></h1><figure><img loading=lazy src=/images/gruv12.png alt=gruv12 width=1000></figure><p>TL;DR NixOS&rsquo;s declarative configuration and flakes make it easy to create
custom services. This post shows how to build a minimal service using flakes
and overlays for a &ldquo;meow&rdquo; command</p><ul><li>This will be a complete minimal configuration for testing purposes.</li></ul><h2 id=create-project-directory>Create Project Directory<a hidden class=anchor aria-hidden=true href=#create-project-directory>#</a></h2><p>Start by creating a directory to hold your project, I called mine <code>meow</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir meow <span style=color:#f92672>&amp;&amp;</span> cd meow
</span></span></code></pre></div><h2 id=create-flake>Create flake<a hidden class=anchor aria-hidden=true href=#create-flake>#</a></h2><p>Create a <code>flake.nix</code> with the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># flake.nix</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  inputs<span style=color:#f92672>.</span>nixpkgs<span style=color:#f92672>.</span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;github:nixos/nixpkgs/nixos-unstable&#34;</span>;
</span></span><span style=display:flex><span>  outputs <span style=color:#f92672>=</span> { self<span style=color:#f92672>,</span> nixpkgs<span style=color:#f92672>,</span> <span style=color:#f92672>...</span> }: {
</span></span><span style=display:flex><span>    overlays<span style=color:#f92672>.</span>default <span style=color:#f92672>=</span> final: prev: {
</span></span><span style=display:flex><span>      meow <span style=color:#f92672>=</span> final<span style=color:#f92672>.</span>writeShellScriptBin <span style=color:#e6db74>&#34;meow&#34;</span> <span style=color:#e6db74>&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        echo meow
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#39;&#39;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    nixosModules<span style=color:#f92672>.</span>default <span style=color:#f92672>=</span> { pkgs<span style=color:#f92672>,</span> config<span style=color:#f92672>,</span> lib<span style=color:#f92672>,</span> <span style=color:#f92672>...</span> }: {
</span></span><span style=display:flex><span>      imports <span style=color:#f92672>=</span> [ <span style=color:#e6db74>./nixos-module.nix</span> ];
</span></span><span style=display:flex><span>      <span style=color:#75715e># inject dependencies from flake.nix, and don&#39;t do anything else</span>
</span></span><span style=display:flex><span>      config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf config<span style=color:#f92672>.</span>services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>enable {
</span></span><span style=display:flex><span>        nixpkgs<span style=color:#f92672>.</span>overlays <span style=color:#f92672>=</span> [ self<span style=color:#f92672>.</span>overlays<span style=color:#f92672>.</span>default ];
</span></span><span style=display:flex><span>        services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>package <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkDefault pkgs<span style=color:#f92672>.</span>meow;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=create-service-module>Create Service Module<a hidden class=anchor aria-hidden=true href=#create-service-module>#</a></h2><p>Next we&rsquo;ll create the <code>nixos-module.nix</code> in the same directory with the
following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># nixos-module.nix</span>
</span></span><span style=display:flex><span>{ pkgs<span style=color:#f92672>,</span> config<span style=color:#f92672>,</span> lib<span style=color:#f92672>,</span> <span style=color:#f92672>...</span> }:
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> cfg <span style=color:#f92672>=</span> config<span style=color:#f92672>.</span>services<span style=color:#f92672>.</span>meow; <span style=color:#66d9ef>in</span> {
</span></span><span style=display:flex><span>  options <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    services<span style=color:#f92672>.</span>meow <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      enable <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;meow&#34;</span>;
</span></span><span style=display:flex><span>      package <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkOption {
</span></span><span style=display:flex><span>        description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;meow package to use&#34;</span>;
</span></span><span style=display:flex><span>        type <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>types<span style=color:#f92672>.</span>package;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf cfg<span style=color:#f92672>.</span>enable {
</span></span><span style=display:flex><span>    systemd<span style=color:#f92672>.</span>services<span style=color:#f92672>.</span>meow <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;meow at the user on the console&#34;</span>;
</span></span><span style=display:flex><span>      serviceConfig <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        Type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;oneshot&#34;</span>;
</span></span><span style=display:flex><span>        ExecStart <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>cfg<span style=color:#f92672>.</span>package<span style=color:#e6db74>}</span><span style=color:#e6db74>/bin/meow&#34;</span>;
</span></span><span style=display:flex><span>        StandardOutput <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;journal+console&#34;</span>;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      wantedBy <span style=color:#f92672>=</span> [ <span style=color:#e6db74>&#34;multi-user.target&#34;</span> ];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=add-nixosconfigurations-output>Add nixosConfigurations Output<a hidden class=anchor aria-hidden=true href=#add-nixosconfigurations-output>#</a></h2><p>Lastly, we will add a <code>nixosConfigurations</code> output to the <code>flake.nix</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># flake.nix</span>
</span></span><span style=display:flex><span>nixosConfigurations<span style=color:#f92672>.</span>test <span style=color:#f92672>=</span> nixpkgs<span style=color:#f92672>.</span>lib<span style=color:#f92672>.</span>nixosSystem {
</span></span><span style=display:flex><span>  system <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;x86_64-linux&#34;</span>;
</span></span><span style=display:flex><span>  modules <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>nixosModules<span style=color:#f92672>.</span>default
</span></span><span style=display:flex><span>    ({ pkgs<span style=color:#f92672>,</span> lib<span style=color:#f92672>,</span> <span style=color:#f92672>...</span> }: {
</span></span><span style=display:flex><span>      fileSystems<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        device <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/dev/sda1&#34;</span>;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      boot<span style=color:#f92672>.</span>loader<span style=color:#f92672>.</span>grub<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      boot<span style=color:#f92672>.</span>initrd<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      boot<span style=color:#f92672>.</span>kernel<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      documentation<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      system<span style=color:#f92672>.</span>stateVersion <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;25.05&#34;</span>;
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><ul><li><code>nixosConfigurations.test</code> is simply the name we chose for this particular
NixOS system configuration.</li></ul><p>The final product will look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># flake.nix</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  inputs<span style=color:#f92672>.</span>nixpkgs<span style=color:#f92672>.</span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;github:nixos/nixpkgs/nixos-unstable&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  outputs <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    self<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    nixpkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>  }: {
</span></span><span style=display:flex><span>    overlays<span style=color:#f92672>.</span>default <span style=color:#f92672>=</span> final: prev: {
</span></span><span style=display:flex><span>      meow <span style=color:#f92672>=</span> final<span style=color:#f92672>.</span>writeShellScriptBin <span style=color:#e6db74>&#34;meow&#34;</span> <span style=color:#e6db74>&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        echo meow
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#39;&#39;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    nixosModules<span style=color:#f92672>.</span>default <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      pkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>      config<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>      lib<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>    }: {
</span></span><span style=display:flex><span>      imports <span style=color:#f92672>=</span> [<span style=color:#e6db74>./nixos-module.nix</span>];
</span></span><span style=display:flex><span>      <span style=color:#75715e># inject dependencies from flake.nix, and don&#39;t do anything else</span>
</span></span><span style=display:flex><span>      config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf config<span style=color:#f92672>.</span>services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>enable {
</span></span><span style=display:flex><span>        nixpkgs<span style=color:#f92672>.</span>overlays <span style=color:#f92672>=</span> [self<span style=color:#f92672>.</span>overlays<span style=color:#f92672>.</span>default];
</span></span><span style=display:flex><span>        services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>package <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkDefault pkgs<span style=color:#f92672>.</span>meow;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    nixosConfigurations<span style=color:#f92672>.</span>test <span style=color:#f92672>=</span> nixpkgs<span style=color:#f92672>.</span>lib<span style=color:#f92672>.</span>nixosSystem {
</span></span><span style=display:flex><span>      system <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;x86_64-linux&#34;</span>;
</span></span><span style=display:flex><span>      modules <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>nixosModules<span style=color:#f92672>.</span>default
</span></span><span style=display:flex><span>        ({
</span></span><span style=display:flex><span>          pkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>          lib<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>        }: {
</span></span><span style=display:flex><span>          fileSystems<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            device <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/dev/sda1&#34;</span>;
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>          boot<span style=color:#f92672>.</span>loader<span style=color:#f92672>.</span>grub<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>          boot<span style=color:#f92672>.</span>initrd<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>          boot<span style=color:#f92672>.</span>kernel<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>          documentation<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          services<span style=color:#f92672>.</span>meow<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          system<span style=color:#f92672>.</span>stateVersion <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;25.05&#34;</span>;
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      ];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=build-the-system-configuration>Build the System Configuration<a hidden class=anchor aria-hidden=true href=#build-the-system-configuration>#</a></h3><p>Then build the system configuration:</p><p><code>nix build .#nixosConfigurations.test.config.system.build.toplevel</code></p><ul><li><p>If this builds successfully you&rsquo;ll see a <code>result</code> directory within your <code>meow</code>
directory.</p></li><li><p>I wouldn&rsquo;t recommend actually switching to this configuration but you could
build it to gain familiarity with it. If you were to switch to it you would
run <code>./result/bin/switch-to-configuration</code></p></li><li><p>Test in a NixOS Virtual Machine (Recommended):The safest way to see the &ldquo;meow&rdquo;
output is to build the configuration and then run it in a NixOS virtual
machine. You can do this using tools like <code>nixos-generate-config</code> and a
virtualization tool (like VirtualBox, QEMU, or GNOME Boxes).</p></li></ul></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tsawyer87.github.io/>NixOS Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>