<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Nix_modules_explained | NixOS Blog</title><meta name=keywords content><meta name=description content='NixOS Modules
TL;DR: In this post I break down the NixOS module system and explain how to
define options. As well as how to test modules with the repl.

Most modules are functions that take an attribute set and return an attribute
set.

Refresher:

An attribute set is a collection of name-value pairs wrapped in curly
braces:

{
  string = "hello";
  int = 3;
}

A function with an attribute set argument:

{ a, b }: a + b

The simplest possible NixOS Module:

{ ... }:
{
}
NixOS produces a full system configuration by combining smaller, more isolated
and reusable components: Modules. In my opinion modules are one of the first
things you should understand when learning about NixOS.'><meta name=author content="T Sawyer"><link rel=canonical href=https://tsawyer87.github.io/posts/nix_modules_explained/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://tsawyer87.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tsawyer87.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tsawyer87.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tsawyer87.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tsawyer87.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tsawyer87.github.io/posts/nix_modules_explained/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://tsawyer87.github.io/posts/nix_modules_explained/"><meta property="og:site_name" content="NixOS Blog"><meta property="og:title" content="Nix_modules_explained"><meta property="og:description" content='NixOS Modules TL;DR: In this post I break down the NixOS module system and explain how to define options. As well as how to test modules with the repl.
Most modules are functions that take an attribute set and return an attribute set. Refresher:
An attribute set is a collection of name-value pairs wrapped in curly braces: { string = "hello"; int = 3; } A function with an attribute set argument: { a, b }: a + b The simplest possible NixOS Module: { ... }: { } NixOS produces a full system configuration by combining smaller, more isolated and reusable components: Modules. In my opinion modules are one of the first things you should understand when learning about NixOS.'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-14T19:03:40-04:00"><meta property="article:modified_time" content="2025-05-14T19:03:40-04:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nix_modules_explained"><meta name=twitter:description content='NixOS Modules
TL;DR: In this post I break down the NixOS module system and explain how to
define options. As well as how to test modules with the repl.

Most modules are functions that take an attribute set and return an attribute
set.

Refresher:

An attribute set is a collection of name-value pairs wrapped in curly
braces:

{
  string = "hello";
  int = 3;
}

A function with an attribute set argument:

{ a, b }: a + b

The simplest possible NixOS Module:

{ ... }:
{
}
NixOS produces a full system configuration by combining smaller, more isolated
and reusable components: Modules. In my opinion modules are one of the first
things you should understand when learning about NixOS.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tsawyer87.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Nix_modules_explained","item":"https://tsawyer87.github.io/posts/nix_modules_explained/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Nix_modules_explained","name":"Nix_modules_explained","description":"NixOS Modules TL;DR: In this post I break down the NixOS module system and explain how to define options. As well as how to test modules with the repl.\nMost modules are functions that take an attribute set and return an attribute set. Refresher:\nAn attribute set is a collection of name-value pairs wrapped in curly braces: { string = \u0026#34;hello\u0026#34;; int = 3; } A function with an attribute set argument: { a, b }: a + b The simplest possible NixOS Module: { ... }: { } NixOS produces a full system configuration by combining smaller, more isolated and reusable components: Modules. In my opinion modules are one of the first things you should understand when learning about NixOS.\n","keywords":[],"articleBody":"NixOS Modules TL;DR: In this post I break down the NixOS module system and explain how to define options. As well as how to test modules with the repl.\nMost modules are functions that take an attribute set and return an attribute set. Refresher:\nAn attribute set is a collection of name-value pairs wrapped in curly braces: { string = \"hello\"; int = 3; } A function with an attribute set argument: { a, b }: a + b The simplest possible NixOS Module: { ... }: { } NixOS produces a full system configuration by combining smaller, more isolated and reusable components: Modules. In my opinion modules are one of the first things you should understand when learning about NixOS.\nA NixOS module defines configuration options and behaviors for system components, allowing users to extend, customize, and compose configurations declaratively.\nA module is a file containing a Nix expression with a specific structure. It declares options for other modules to define (give a value). Modules were introduced to allow extending NixOS without modifying its source code.\nTo define any values, the module system first has to know which ones are allowed. This is done by declaring options that specify which attributes can be set and used elsewhere.\nIf you want to write your own modules, I recommend setting up nixd or nil with your editor of choice. This will allow your editor to warn you about missing arguments and dependencies as well as syntax errors.\nDeclaring Options The following is nixpkgs/nixos/modules/programs/vim.nix:\n{ config, lib, pkgs, ... }: let cfg = config.programs.vim; in { options.programs.vim = { enable = lib.mkEnableOption \"Vi IMproved, an advanced text\"; defaultEditor = lib.mkEnableOption \"vim as the default editor\"; package = lib.mkPackageOption pkgs \"vim\" { example = \"vim-full\"; }; }; # TODO: convert it into assert after 24.11 release config = lib.mkIf (cfg.enable || cfg.defaultEditor) { warnings = lib.mkIf (cfg.defaultEditor \u0026\u0026 !cfg.enable) [ \"programs.vim.defaultEditor will only work if programs.vim.enable is enabled, which will be enforced after the 24.11 release\" ]; environment = { systemPackages = [ cfg.package ]; variables.EDITOR = lib.mkIf cfg.defaultEditor (lib.mkOverride 900 \"vim\"); pathsToLink = [ \"/share/vim-plugins\" ]; }; }; } It provides options to enable Vim, set it as the default editor, and specify the Vim package to use. Module Inputs and Structure: { config, lib, pkgs, ... } Inputs: The module takes the above inputs and ... (catch-all for other args) config: Allows the module to read option values (e.g. config.programs.vim.enable). It provides access to the evaluated configuration.\nlib: The Nixpkgs library, giving us helper functions like mkEnableOption , mkIf, and mkOverride.\npkgs: The Nixpkgs package set, used to access packages like pkgs.vim\n...: Allows the module to accept additional arguments, making it flexible for extension in the future.\nKey Takeaways: A NixOS module is typically a function that can include config, lib, and pkgs, but it doesn’t require them. The ... argument ensures flexibility, allowing a module to accept extra inputs without breaking future compatibility. Using lib simplifies handling options (mkEnableOption, mkIf, mkOverride) and helps follow best practices. Modules define options, which users can set in their configuration, and config, which applies changes based on those options.\nLocal Configuration Reference: let cfg = config.programs.vim; in This is a local alias. Instead of typing config.programs.vim over and over, the module uses cfg. Option Declaration options.programs.vim = { enable = lib.mkEnableOption \"Vi IMproved, an advanced text\"; defaultEditor = lib.mkEnableOption \"vim as the default editor\"; package = lib.mkPackageOption pkgs \"vim\" { example = \"vim-full\"; }; }; This defines three user-configurable options:\nenable: Turns on Vim support system-wide.\ndefaultEditor: Sets Vim as the system’s default $EDITOR.\npackage: lets the user override which Vim package is used.\nmkPackageOption is a helper that defines a package-typed option with a default (pkgs.vim) and provides docs + example.\nConditional Configuration config = lib.mkIf (cfg.enable || cfg.defaultEditor) { This block is only activated if either programs.vim.enable or defaultEditor is set. Warnings warnings = lib.mkIf (cfg.defaultEditor \u0026\u0026 !cfg.enable) [ \"programs.vim.defaultEditor will only work if programs.vim.enable is enabled, which will be enforced after the 24.11 release\" ]; Gives you a soft warning if you try to set defaultEditor = true without also enabling Vim. Actual System Config Changes environment = { systemPackages = [ cfg.package ]; variables.EDITOR = lib.mkIf cfg.defaultEditor (lib.mkOverride 900 \"vim\"); pathsToLink = [ \"/share/vim-plugins\" ]; }; It adds Vim to your systemPackages, sets $EDITOR if defaultEditor is true, and makes /share/vim-plugins available in the environment. The following is a bat home-manager module that I wrote:\n# bat.nix { pkgs, config, lib, ... }: let cfg = config.custom.batModule; in { options.custom.batModule.enable = lib.mkOption { type = lib.types.bool; default = false; description = \"Enable bat module\"; }; config = lib.mkIf cfg.enable { programs.bat = { enable = true; themes = { dracula = { src = pkgs.fetchFromGitHub { owner = \"dracula\"; repo = \"sublime\"; # Bat uses sublime syntax for its themes rev = \"26c57ec282abcaa76e57e055f38432bd827ac34e\"; sha256 = \"019hfl4zbn4vm4154hh3bwk6hm7bdxbr1hdww83nabxwjn99ndhv\"; }; file = \"Dracula.tmTheme\"; }; }; extraPackages = with pkgs.bat-extras; [ batdiff batman prettybat batgrep ]; }; }; } Now I could add this to my home.nix to enable it:\n# home.nix custom = { batModule.enable = true; } If I set this option to true the bat configuration is dropped in place. If it’s not set to true, it won’t put the bat configuration in the system. Same as with options defined in modules within the Nixpkgs repository.\nIf I had set the default to true, it would automatically enable the module without requiring an explicit custom.batModule.enable = true; call in my home.nix.\nModule Composition NixOS achieves its full system configuration by combining the configurations defined in various modules. This composition is primarily handled through the imports mechanism.\nimports: This is a standard option within a NixOS or Home Manager configuration (often found in your configuration.nix or home.nix). It takes a list of paths to other Nix modules. When you include a module in the imports list, the options and configurations defined in that module become part of your overall system configuration.\nYou declaratively state the desired state of your system by setting options across various modules. The NixOS build system then evaluates and merges these option settings. The culmination of this process, which includes building the entire system closure, is represented by the derivation built by config.system.build.toplevel.\nNixOS Modules and Dependency Locking with npins This is the file structure:\n❯ tree . ├── configuration.nix ├── default.nix ├── desktop.nix └── npins ├── default.nix └── sources.json This uses npins for dependency locking. Install it and run this in the project\ndirectory:\nnpins init Create a default.nix with the following:\n# default.nix { system ? builtins.currentSystem, sources ? import ./npins, }: let pkgs = import sources.nixpkgs { config = { }; overlays = [ ]; }; inherit (pkgs) lib; in lib.makeScope pkgs.newScope (self: { shell = pkgs.mkShell { packages = [ pkgs.npins self.myPackage ]; }; # inherit lib; nixosSystem = import (sources.nixpkgs + \"/nixos\") { configuration = ./configuration.nix; }; moduleEvale = lib.evalModules { modules = [ # ... ]; }; }) A configuration.nix with the following:\n# configuration.nix { boot.loader.grub.device = \"nodev\"; fileSystems.\"/\".device = \"/devst\"; system.stateVersion = \"25.05\"; # declaring options means to declare a new option # defining options means to define a value of an option imports = [ # ./main.nix ./desktop.nix # Files # ./minimal.nix ]; # mine.desktop.enable = true; } And a desktop.nix with the following:\n# desktop.nix { pkgs, lib, config, ... }: { imports = []; # Define an option to enable or disable desktop configuration options.mine.desktop.enable = lib.mkEnableOption \"desktop settings\"; # Configuration that applies when the option is enabled config = lib.mkIf config.mine.desktop.enable { environment.systemPackages = [ pkgs.git ]; }; } mkEnableOption defaults to false. Now in your configuration.nix you can uncomment mine.desktop.enable = true; to enable the desktop config and vice-versa.\nYou can test that this works by running:\nnix-instantiate -A nixosSystem.system nix-instantiate performs only the evaluation phase of Nix expressions. During this phase, Nix interprets the Nix code, resolves all dependencies, and constructs derivations but does not execute any build actions. Useful for testing. To check if this worked and git is installed in systemPackages you can load it into nix repl but first you’ll want lib to be available so uncomment this in your default.nix:\n# default.nix inherit lib; Rerun nix-instantiate -A nixosSystem.system\nThen load the repl and check that git is in systemPackages:\nnix repl -f . nix-repl\u003e builtins.filter (pkg: lib.hasPrefix \"git\" pkg.name) nixosSystem.config.environment.systemPackages This shows the path to the derivation\nCheck that mine.desktop.enable is true\nnix-repl\u003e nixosSystem.config.mine.desktop.enable true Resources on Modules WritingNixOsModules\nNixWikiNixOSModules\nnix.dev A basic module\nModuleSystemDeepDive\nMakingNixOSModulesForFun\nxeiaso Nixos Modules for fun \u0026 profit\nNixOS Flakes Book Module System\nVideos NixHour Writing NixOS modules – This example is from this video infinisilModules\ntweagModuleSystemRecursion ","wordCount":"1453","inLanguage":"en","datePublished":"2025-05-14T19:03:40-04:00","dateModified":"2025-05-14T19:03:40-04:00","author":{"@type":"Person","name":"T Sawyer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tsawyer87.github.io/posts/nix_modules_explained/"},"publisher":{"@type":"Organization","name":"NixOS Blog","logo":{"@type":"ImageObject","url":"https://tsawyer87.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tsawyer87.github.io/ accesskey=h title="NixOS Blog (Alt + H)">NixOS Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
<a href=/index.xml title="RSS Feed"><img src=/images/rss.png alt="RSS Feed" style=width:24px;height:24px></a></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Nix_modules_explained</h1><div class=post-meta><span title='2025-05-14 19:03:40 -0400 EDT'>May 14, 2025</span>&nbsp;·&nbsp;T Sawyer</div></header><div class=post-content><h1 id=nixos-modules>NixOS Modules<a hidden class=anchor aria-hidden=true href=#nixos-modules>#</a></h1><p>TL;DR: In this post I break down the NixOS module system and explain how to
define options. As well as how to test modules with the repl.</p><ul><li>Most modules are functions that take an attribute set and return an attribute
set.</li></ul><p><strong>Refresher</strong>:</p><ul><li>An <strong>attribute set</strong> is a collection of name-value pairs wrapped in curly
braces:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{
</span></span><span style=display:flex><span>  string <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;hello&#34;</span>;
</span></span><span style=display:flex><span>  int <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>A <strong>function</strong> with an attribute set argument:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{ a<span style=color:#f92672>,</span> b }: a <span style=color:#f92672>+</span> b
</span></span></code></pre></div><ul><li>The simplest possible <strong>NixOS Module</strong>:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{ <span style=color:#f92672>...</span> }:
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>NixOS produces a full system configuration by combining smaller, more isolated
and reusable components: <strong>Modules</strong>. In my opinion modules are one of the first
things you should understand when learning about NixOS.</p><ul><li><p>A NixOS module defines configuration options and behaviors for system
components, allowing users to extend, customize, and compose configurations
declaratively.</p></li><li><p>A <strong>module</strong> is a file containing a Nix expression with a specific structure.
It <em>declares</em> options for other modules to define (give a value). Modules were
introduced to allow extending NixOS without modifying its source code.</p></li><li><p>To define any values, the module system first has to know which ones are
allowed. This is done by declaring options that specify which attributes can
be set and used elsewhere.</p></li><li><p>If you want to write your own modules, I recommend setting up
<a href="https://github.com/nix-community/nixd?tab=readme-ov-file">nixd</a> or
<a href=https://github.com/oxalica/nil>nil</a> with your editor of choice. This will
allow your editor to warn you about missing arguments and dependencies as well
as syntax errors.</p></li></ul><h2 id=declaring-options>Declaring Options<a hidden class=anchor aria-hidden=true href=#declaring-options>#</a></h2><p>The following is <code>nixpkgs/nixos/modules/programs/vim.nix</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{
</span></span><span style=display:flex><span>  config<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  lib<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  pkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  cfg <span style=color:#f92672>=</span> config<span style=color:#f92672>.</span>programs<span style=color:#f92672>.</span>vim;
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span>programs<span style=color:#f92672>.</span>vim <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    enable <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;Vi IMproved, an advanced text&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    defaultEditor <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;vim as the default editor&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    package <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkPackageOption pkgs <span style=color:#e6db74>&#34;vim&#34;</span> { example <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vim-full&#34;</span>; };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># TODO: convert it into assert after 24.11 release</span>
</span></span><span style=display:flex><span>  config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf (cfg<span style=color:#f92672>.</span>enable <span style=color:#f92672>||</span> cfg<span style=color:#f92672>.</span>defaultEditor) {
</span></span><span style=display:flex><span>    warnings <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf (cfg<span style=color:#f92672>.</span>defaultEditor <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>cfg<span style=color:#f92672>.</span>enable) [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;programs.vim.defaultEditor will only work if programs.vim.enable is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       enabled, which will be enforced after the 24.11 release&#34;</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    environment <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      systemPackages <span style=color:#f92672>=</span> [ cfg<span style=color:#f92672>.</span>package ];
</span></span><span style=display:flex><span>      variables<span style=color:#f92672>.</span>EDITOR <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf cfg<span style=color:#f92672>.</span>defaultEditor (lib<span style=color:#f92672>.</span>mkOverride <span style=color:#ae81ff>900</span> <span style=color:#e6db74>&#34;vim&#34;</span>);
</span></span><span style=display:flex><span>      pathsToLink <span style=color:#f92672>=</span> [ <span style=color:#e6db74>&#34;/share/vim-plugins&#34;</span> ];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>It provides options to enable Vim, set it as the default editor, and specify
the Vim package to use.</li></ul><ol><li>Module Inputs and Structure:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{
</span></span><span style=display:flex><span>  config<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  lib<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  pkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Inputs: The module takes the above inputs and <code>...</code> (catch-all for other args)<ul><li><p><code>config</code>: Allows the module to read option values (e.g.
<code>config.programs.vim.enable</code>). It provides access to the evaluated
configuration.</p></li><li><p><code>lib</code>: The Nixpkgs library, giving us helper functions like <code>mkEnableOption</code>
, <code>mkIf</code>, and <code>mkOverride</code>.</p></li><li><p><code>pkgs</code>: The Nixpkgs package set, used to access packages like <code>pkgs.vim</code></p></li><li><p><code>...</code>: Allows the module to accept additional arguments, making it flexible
for extension in the future.</p></li></ul></li></ul><blockquote><p>Key Takeaways: A NixOS module is typically a function that can include
<code>config</code>, <code>lib</code>, and <code>pkgs</code>, but it doesn’t require them. The <code>...</code> argument
ensures flexibility, allowing a module to accept extra inputs without breaking
future compatibility. Using <code>lib</code> simplifies handling options (mkEnableOption,
mkIf, mkOverride) and helps follow best practices. Modules define options,
which users can set in their configuration, and <code>config</code>, which applies
changes based on those options.</p></blockquote><ol start=2><li>Local Configuration Reference:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  cfg <span style=color:#f92672>=</span> config<span style=color:#f92672>.</span>programs<span style=color:#f92672>.</span>vim;
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span>
</span></span></code></pre></div><ul><li>This is a local alias. Instead of typing <code>config.programs.vim</code> over and over,
the module uses <code>cfg</code>.</li></ul><ol start=3><li>Option Declaration</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>options<span style=color:#f92672>.</span>programs<span style=color:#f92672>.</span>vim <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  enable <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;Vi IMproved, an advanced text&#34;</span>;
</span></span><span style=display:flex><span>  defaultEditor <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;vim as the default editor&#34;</span>;
</span></span><span style=display:flex><span>  package <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkPackageOption pkgs <span style=color:#e6db74>&#34;vim&#34;</span> { example <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vim-full&#34;</span>; };
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>This defines three user-configurable options:</p><ul><li><p><code>enable</code>: Turns on Vim support system-wide.</p></li><li><p><code>defaultEditor</code>: Sets Vim as the system&rsquo;s default <code>$EDITOR</code>.</p></li><li><p><code>package</code>: lets the user override which Vim package is used.</p></li></ul><blockquote><p><code>mkPackageOption</code> is a helper that defines a package-typed option with a
default (<code>pkgs.vim</code>) and provides docs + example.</p></blockquote><ol start=4><li>Conditional Configuration</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf (cfg<span style=color:#f92672>.</span>enable <span style=color:#f92672>||</span> cfg<span style=color:#f92672>.</span>defaultEditor) {
</span></span></code></pre></div><ul><li>This block is only activated if <em>either</em> <code>programs.vim.enable</code> or
<code>defaultEditor</code> is set.</li></ul><ol start=5><li>Warnings</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>warnings <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf (cfg<span style=color:#f92672>.</span>defaultEditor <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>cfg<span style=color:#f92672>.</span>enable) [
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;programs.vim.defaultEditor will only work if programs.vim.enable is enabled,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   which will be enforced after the 24.11 release&#34;</span>
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><ul><li>Gives you a soft warning if you try to set <code>defaultEditor = true</code> without also
enabling Vim.</li></ul><ol start=6><li>Actual System Config Changes</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>environment <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  systemPackages <span style=color:#f92672>=</span> [ cfg<span style=color:#f92672>.</span>package ];
</span></span><span style=display:flex><span>  variables<span style=color:#f92672>.</span>EDITOR <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf cfg<span style=color:#f92672>.</span>defaultEditor (lib<span style=color:#f92672>.</span>mkOverride <span style=color:#ae81ff>900</span> <span style=color:#e6db74>&#34;vim&#34;</span>);
</span></span><span style=display:flex><span>  pathsToLink <span style=color:#f92672>=</span> [ <span style=color:#e6db74>&#34;/share/vim-plugins&#34;</span> ];
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><ul><li>It adds Vim to your <code>systemPackages</code>, sets <code>$EDITOR</code> if <code>defaultEditor</code> is
true, and makes <code>/share/vim-plugins</code> available in the environment.</li></ul><p>The following is a bat home-manager module that I wrote:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># bat.nix</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  pkgs<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  config<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  lib<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}: <span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  cfg <span style=color:#f92672>=</span> config<span style=color:#f92672>.</span>custom<span style=color:#f92672>.</span>batModule;
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span> {
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span>custom<span style=color:#f92672>.</span>batModule<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkOption {
</span></span><span style=display:flex><span>    type <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>types<span style=color:#f92672>.</span>bool;
</span></span><span style=display:flex><span>    default <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Enable bat module&#34;</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf cfg<span style=color:#f92672>.</span>enable {
</span></span><span style=display:flex><span>    programs<span style=color:#f92672>.</span>bat <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>      themes <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        dracula <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>          src <span style=color:#f92672>=</span> pkgs<span style=color:#f92672>.</span>fetchFromGitHub {
</span></span><span style=display:flex><span>            owner <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dracula&#34;</span>;
</span></span><span style=display:flex><span>            repo <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sublime&#34;</span>; <span style=color:#75715e># Bat uses sublime syntax for its themes</span>
</span></span><span style=display:flex><span>            rev <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;26c57ec282abcaa76e57e055f38432bd827ac34e&#34;</span>;
</span></span><span style=display:flex><span>            sha256 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;019hfl4zbn4vm4154hh3bwk6hm7bdxbr1hdww83nabxwjn99ndhv&#34;</span>;
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>          file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dracula.tmTheme&#34;</span>;
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      extraPackages <span style=color:#f92672>=</span> <span style=color:#66d9ef>with</span> pkgs<span style=color:#f92672>.</span>bat-extras; [
</span></span><span style=display:flex><span>        batdiff
</span></span><span style=display:flex><span>        batman
</span></span><span style=display:flex><span>        prettybat
</span></span><span style=display:flex><span>        batgrep
</span></span><span style=display:flex><span>      ];
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now I could add this to my <code>home.nix</code> to enable it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># home.nix</span>
</span></span><span style=display:flex><span>custom <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  batModule<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><p>If I set this option to true the bat configuration is dropped in place. If
it&rsquo;s not set to true, it won&rsquo;t put the bat configuration in the system. Same
as with options defined in modules within the Nixpkgs repository.</p></li><li><p>If I had set the default to <code>true</code>, it would automatically enable the module
without requiring an explicit <code>custom.batModule.enable = true;</code> call in my
<code>home.nix</code>.</p></li></ul><h3 id=module-composition>Module Composition<a hidden class=anchor aria-hidden=true href=#module-composition>#</a></h3><ul><li><p>NixOS achieves its full system configuration by combining the configurations
defined in various modules. This composition is primarily handled through the
<code>imports</code> mechanism.</p></li><li><p><code>imports</code>: This is a standard option within a NixOS or Home Manager
configuration (often found in your configuration.nix or home.nix). It takes a
list of paths to other Nix modules. When you include a module in the imports
list, the options and configurations defined in that module become part of
your overall system configuration.</p></li><li><p>You declaratively state the desired state of your system by setting options
across various modules. The NixOS build system then evaluates and merges these
option settings. The culmination of this process, which includes building the
entire system closure, is represented by the derivation built by
<code>config.system.build.toplevel</code>.</p></li></ul><h3 id=nixos-modules-and-dependency-locking-with-npins>NixOS Modules and Dependency Locking with npins<a hidden class=anchor aria-hidden=true href=#nixos-modules-and-dependency-locking-with-npins>#</a></h3><p>This is the file structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ tree
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── configuration.nix
</span></span><span style=display:flex><span>├── default.nix
</span></span><span style=display:flex><span>├── desktop.nix
</span></span><span style=display:flex><span>└── npins
</span></span><span style=display:flex><span>    ├── default.nix
</span></span><span style=display:flex><span>    └── sources.json
</span></span></code></pre></div><p>This uses <code>npins</code> for dependency locking. Install it and run this in the project</p><p>directory:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npins init
</span></span></code></pre></div><p>Create a <code>default.nix</code> with the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># default.nix</span>
</span></span><span style=display:flex><span>{ system <span style=color:#f92672>?</span> builtins<span style=color:#f92672>.</span>currentSystem<span style=color:#f92672>,</span> sources <span style=color:#f92672>?</span> <span style=color:#f92672>import</span> <span style=color:#e6db74>./npins</span><span style=color:#f92672>,</span> }:
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  pkgs <span style=color:#f92672>=</span> <span style=color:#f92672>import</span> sources<span style=color:#f92672>.</span>nixpkgs {
</span></span><span style=display:flex><span>    config <span style=color:#f92672>=</span> { };
</span></span><span style=display:flex><span>    overlays <span style=color:#f92672>=</span> [ ];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>inherit</span> (pkgs) lib;
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span> lib<span style=color:#f92672>.</span>makeScope pkgs<span style=color:#f92672>.</span>newScope (self: {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  shell <span style=color:#f92672>=</span> pkgs<span style=color:#f92672>.</span>mkShell { packages <span style=color:#f92672>=</span> [ pkgs<span style=color:#f92672>.</span>npins self<span style=color:#f92672>.</span>myPackage ]; };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># inherit lib;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  nixosSystem <span style=color:#f92672>=</span> <span style=color:#f92672>import</span> (sources<span style=color:#f92672>.</span>nixpkgs <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/nixos&#34;</span>) {
</span></span><span style=display:flex><span>    configuration <span style=color:#f92672>=</span> <span style=color:#e6db74>./configuration.nix</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  moduleEvale <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>evalModules {
</span></span><span style=display:flex><span>    modules <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>A <code>configuration.nix</code> with the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># configuration.nix</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  boot<span style=color:#f92672>.</span>loader<span style=color:#f92672>.</span>grub<span style=color:#f92672>.</span>device <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;nodev&#34;</span>;
</span></span><span style=display:flex><span>  fileSystems<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>.</span>device <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/devst&#34;</span>;
</span></span><span style=display:flex><span>  system<span style=color:#f92672>.</span>stateVersion <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;25.05&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># declaring options means to declare a new option</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># defining options means to define a value of an option</span>
</span></span><span style=display:flex><span>  imports <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#75715e># ./main.nix</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>./desktop.nix</span> <span style=color:#75715e># Files</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ./minimal.nix</span>
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># mine.desktop.enable = true;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And a <code>desktop.nix</code> with the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># desktop.nix</span>
</span></span><span style=display:flex><span>{ pkgs<span style=color:#f92672>,</span> lib<span style=color:#f92672>,</span> config<span style=color:#f92672>,</span> <span style=color:#f92672>...</span> }:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  imports <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Define an option to enable or disable desktop configuration</span>
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span>mine<span style=color:#f92672>.</span>desktop<span style=color:#f92672>.</span>enable <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkEnableOption <span style=color:#e6db74>&#34;desktop settings&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Configuration that applies when the option is enabled</span>
</span></span><span style=display:flex><span>  config <span style=color:#f92672>=</span> lib<span style=color:#f92672>.</span>mkIf config<span style=color:#f92672>.</span>mine<span style=color:#f92672>.</span>desktop<span style=color:#f92672>.</span>enable {
</span></span><span style=display:flex><span>    environment<span style=color:#f92672>.</span>systemPackages <span style=color:#f92672>=</span> [ pkgs<span style=color:#f92672>.</span>git ];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>mkEnableOption</code> defaults to false. Now in your <code>configuration.nix</code> you can
uncomment <code>mine.desktop.enable = true;</code> to enable the desktop config and
vice-versa.</p><p>You can test that this works by running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nix-instantiate -A nixosSystem.system
</span></span></code></pre></div><ul><li><code>nix-instantiate</code> performs only the evaluation phase of Nix expressions.
During this phase, Nix interprets the Nix code, resolves all dependencies, and
constructs derivations but does not execute any build actions. Useful for
testing.</li></ul><p>To check if this worked and <code>git</code> is installed in systemPackages you can load it
into <code>nix repl</code> but first you&rsquo;ll want <code>lib</code> to be available so uncomment this in
your <code>default.nix</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#75715e># default.nix</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>inherit</span> lib;
</span></span></code></pre></div><p>Rerun <code>nix-instantiate -A nixosSystem.system</code></p><p>Then load the repl and check that <code>git</code> is in <code>systemPackages</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nix repl -f .
</span></span><span style=display:flex><span>nix-repl&gt; builtins.filter <span style=color:#f92672>(</span>pkg: lib.hasPrefix <span style=color:#e6db74>&#34;git&#34;</span> pkg.name<span style=color:#f92672>)</span> nixosSystem.config.environment.systemPackages
</span></span></code></pre></div><p>This shows the path to the derivation</p><p>Check that mine.desktop.enable is true</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>nix-repl<span style=color:#f92672>&gt;</span> nixosSystem<span style=color:#f92672>.</span>config<span style=color:#f92672>.</span>mine<span style=color:#f92672>.</span>desktop<span style=color:#f92672>.</span>enable
</span></span><span style=display:flex><span><span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h3 id=resources-on-modules>Resources on Modules<a hidden class=anchor aria-hidden=true href=#resources-on-modules>#</a></h3><ul><li><p><a href=https://nixos.org/manual/nixos/stable/#sec-writing-modules>WritingNixOsModules</a></p></li><li><p><a href=https://nixos.wiki/wiki/NixOS_modules>NixWikiNixOSModules</a></p></li><li><p><a href=https://nix.dev/tutorials/module-system/a-basic-module/index.html>nix.dev A basic module</a></p></li><li><p><a href=https://nix.dev/tutorials/module-system/deep-dive#module-system-deep-dive>ModuleSystemDeepDive</a></p></li><li><p><a href=https://xeiaso.net/talks/asg-2023-nixos/>MakingNixOSModulesForFun</a></p></li><li><p><a href=https://xeiaso.net/talks/asg-2023-nixos/>xeiaso Nixos Modules for fun & profit</a></p></li><li><p><a href=https://nixos-and-flakes.thiscute.world/other-usage-of-flakes/module-system>NixOS Flakes Book Module System</a></p></li></ul><h1 id=videos>Videos<a hidden class=anchor aria-hidden=true href=#videos>#</a></h1><p><a href="https://www.youtube.com/watch?v=N7hFP_40DJo&amp;t=17s">NixHour Writing NixOS modules</a>
&ndash; This example is from this video
<a href=https://infinisil.com/modules.mp4>infinisilModules</a></p><h1 id=tweagmodulesystemrecursion><a href="https://www.youtube.com/watch?v=cZjOzOHb2ow">tweagModuleSystemRecursion</a><a hidden class=anchor aria-hidden=true href=#tweagmodulesystemrecursion>#</a></h1></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tsawyer87.github.io/>NixOS Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>