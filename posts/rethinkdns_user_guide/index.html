<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>RethinkDNS_User_Guide | NixOS Blog</title><link rel=icon href=favicon.svg sizes=any type=image/svg+xml><meta property="og:url" content="https://TSawyer87.github.io/posts/rethinkdns_user_guide/"><meta property="og:site_name" content="NixOS Blog"><meta property="og:title" content="RethinkDNS_User_Guide"><meta property="og:description" content="RethinkDNS Users Guide I‚Äôm not affiliated with RethinkDNS in any way, I‚Äôm just a technologist with privacy concerns.
üîë Key Terms ‚úîÔ∏è Click to Expand Key Terms IP (Internet Protocol) is the address system of the internet, responsible for delivering packets of data from a source device to a target device. IP is the main way in which connections are made, and is the backbone of the internet. It doesn‚Äôt check for errors or ensure the packets are in the correct order, that‚Äôs where TCP comes in. When you set an IP rule this is what you‚Äôre setting, a trusted IP address."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-11T08:00:32-04:00"><meta property="article:modified_time" content="2025-09-11T08:00:32-04:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RethinkDNS_User_Guide"><meta name=twitter:description content="RethinkDNS Users Guide I‚Äôm not affiliated with RethinkDNS in any way, I‚Äôm just a technologist with privacy concerns.
üîë Key Terms ‚úîÔ∏è Click to Expand Key Terms IP (Internet Protocol) is the address system of the internet, responsible for delivering packets of data from a source device to a target device. IP is the main way in which connections are made, and is the backbone of the internet. It doesn‚Äôt check for errors or ensure the packets are in the correct order, that‚Äôs where TCP comes in. When you set an IP rule this is what you‚Äôre setting, a trusted IP address."><link rel=stylesheet href=/css/root.min.0e732b812b9751962e01a7c4798a1211cd5f8ac8abec7f99793fe306989e459f.css integrity="sha256-DnMrgSuXUZYuAafEeYoSEc1fisir7H+ZeT/jBpieRZ8=" crossorigin=anonymous><link rel=stylesheet href=/css/bundle.min.59eb1a059f8cd558e64375ede3e68d3e9120ddb0c6bdbab555c247689cef59e1.css integrity="sha256-WesaBZ+M1VjmQ3Xt4+aNPpEg3bDGvbq1VcJHaJzvWeE=" crossorigin=anonymous><script src=/js/bundle.995e4ec99401021e081ec256bee66154ef7f4e5136809432513b2e6d014b4b1d.js integrity="sha256-mV5OyZQBAh4IHsJWvuZhVO9/TlE2gJQyUTsubQFLSx0=" crossorigin=anonymous></script><script defer src=/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js integrity="sha256-ZFlLEl97eL30+oMWlVkiu+uxzWuu8/FmVL/KIDCfGPg="></script><script defer src=/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js integrity="sha256-HZgPhN8R8+t8jF8X9UHUmgYRYI3xed10+n8GIl61as4="></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet></head><body class=notransition><div id=container><header id=main-header><div role=navigation aria-label=Main><div class=nav-left><a href=https://TSawyer87.github.io/ style=color:inherit>NixOS Blog</a></div><div class=nav-right><div style=position:absolute;width:0;height:0><div id=nav-dropdown-menu class=hidden href=#><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div></div></div><a id=nav-dropdown-button href=#><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div id=nav-menu><div class=nav-item><a aria-current=true class=ancestor href=/posts/>Posts</a></div></div><a id=theme-switcher href=#><svg class="light-icon" viewBox="0 0 24 24" fill="none"><path d="M12 3V4m0 16v1M4 12H3M6.31412 6.31412 5.5 5.5m12.1859.81412L18.5 5.5M6.31412 17.69 5.5 18.5001M17.6859 17.69 18.5 18.5001M21 12H20m-4 0c0 2.2091-1.7909 4-4 4-2.20914.0-4-1.7909-4-4 0-2.20914 1.79086-4 4-4 2.2091.0 4 1.79086 4 4z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
<svg class="dark-icon" viewBox="0 0 24 24" fill="none"><path d="M3.32031 11.6835c0 4.9706 4.02944 9 8.99999 9 3.7872.0 7.028-2.3392 8.3565-5.6515C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834c-4.9706.0-8.99999-4.0294-8.99999-8.99998C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996 5.65605 4.66028 3.32031 7.89912 3.32031 11.6835z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></a></div></div></header><div class="flex grow"><div id=main-pane><main id=main-content><div class=single-header><ol class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://TSawyer87.github.io/><span itemprop=name>Home</span>
</a><meta itemprop=position content='1'></li><span>&nbsp¬ª&nbsp</span><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://TSawyer87.github.io/posts/><span itemprop=name>Posts</span>
</a><meta itemprop=position content='2'></li><span>&nbsp¬ª&nbsp</span></ol><h1>RethinkDNS_User_Guide</h1><time class=dim datetime=2025-09-11T08:00:32-04:00>September 11, 2025</time></div><section class=page-section><h2 id=rethinkdns-users-guide>RethinkDNS Users Guide</h2><figure><img src=/images/rethinkdns.png alt="RethinkDNS logo" width=500></figure><blockquote><p>I&rsquo;m not affiliated with RethinkDNS in any way, I&rsquo;m just a technologist with
privacy concerns.</p></blockquote><h3 id=-key-terms>üîë Key Terms</h3><details><summary>‚úîÔ∏è Click to Expand Key Terms</summary><div><ul><li><p><strong>IP</strong> (Internet Protocol) is the address system of the internet, responsible
for delivering packets of data from a source device to a target device. IP is
the main way in which connections are made, and is the backbone of the
internet. It doesn&rsquo;t check for errors or ensure the packets are in the correct
order, that&rsquo;s where TCP comes in. When you set an <code>IP rule</code> this is what
you&rsquo;re setting, a trusted IP address.</p></li><li><p><strong>Port</strong>: A port in networking is a virtual communication endpoint managed by
a computer&rsquo;s operating system that helps direct network traffic to specific
apps or services. While an IP address identifies a device on a network, ports
allow the system to know exactly which app or service should handle the
incoming or outgoing data. Web traffic commonly uses port 80 (HTTP) or 443
(HTTPS), so when data arrives for those ports, it&rsquo;s routed to the web server
application on the device. When we block port 80, we block insecure HTTP
connections.</p></li><li><p><strong>TCP</strong> (Transmission Control Protocol) is responsible for maintaining a
connection through a handshake and putting the packets in the correct order.
TCP will also ask for missing pieces and is known as a reliable but slow
protocol.</p></li><li><p><strong>UDP</strong> (User Datagram Protocol) (UDP/IP): is a fast protocol used across the
internet for time-sensitive transmissions such as DNS lookups or VoIP. UDP
allows a computer to send data straight to another without requiring a
handshake.</p></li><li><p><strong>DNS Server</strong>: When you search for a domain name (rethinkdns.com) it triggers
a DNS lookup. Several different types of DNS servers typically work together
to complete a single DNS lookup.</p></li><li><p><strong>Recursive resolver</strong> (DNS recursor): is typically the first stop in the
series of the above servers.</p></li><li><p><strong>Interative resolver</strong>: In an iterative DNS query, each DNS server responds
directly to the client with a referral to another server, and the client
continues querying successive servers until it receives the IP address for the
requested domain.</p></li><li><p><strong>Proxy</strong>: A proxy, in relation to Orbot with Rethink, is an intermediary
service that routes internet traffic from your device through the Tor network
to provide privacy and anonymity.</p></li><li><p><code>Bypass DNS and Firewall</code>: When you choose this setting, it does exactly that.
The app that is allowed to bypass will not have it&rsquo;s traffic routed through
the Rethink encrypted tunnel and will fall back to your systems Private DNS
setting. Rethink will still be aware of the app but it won&rsquo;t route its
traffic.</p></li><li><p><code>Bypass Universal</code>: Similar to <code>Bypass DNS and Firewall</code> with the added bypass
of any filters or blocklists. So your extreme privacy blocklist won&rsquo;t block
this app. Rethink will still be aware of said app.</p></li><li><p><code>Exclude</code>: Rethink will not be aware of this app and it will not be routed
through RethinkDNS.</p></li><li><p>üõú(Unmetered Wi-Fi): Wi-Fi settings, either blocked or allowed.</p></li><li><p>üì∂ (Metered mobile): Mobile data settings, either blocked or allowed.</p></li></ul></div></details><h2 id=rethinkdns-overview>RethinkDNS Overview</h2><p>The DNS mode routes all DNS traffic generated by all apps to <strong>any</strong> user chosen
DNS-over-HTTPS, DNS-over-TLS, DNSCrypt, or Oblivious DNS-over-HTTPS resolver.</p><p>Firewalls like Rethink that block both UDP and TCP connections are usually
sufficient because nearly all applications rely on these two protocols for their
networking and communication. Almost every app communicates over TCP or UDP, so
blocking these protocols effectively restricts most network traffic from and to
apps, preventing them from connecting without permission.</p><p>I will share how I use RethinkDNS, obviously feel free to make changes based on
your threat model and needs.</p><h2 id=getting-started>Getting Started</h2><h3 id=dns>DNS</h3><p>Go to <code>Configure -> DNS -> Other DNS</code>:</p><ul><li><p>Choose the type of resolver you want, I use DNSCrypt. Once you click you can
choose the specific resolver you want such as Adguard. You may notice that it
says <code>Failed: using fallback DNS</code>. This is only because we haven&rsquo;t turned it
on yet, we will recheck this once we turn it on.</p></li><li><p>If you want a relay in a specific country, you can click the <code>Relays</code> tab. For
DNSCrypt you are given the choice between the Netherlands, France, Sweden, Los
Angeles, and Singapore. You might do this if you were trying to circumvent
censorship.</p></li></ul><p><strong>Rules</strong> set the following:</p><ul><li><p><code>Advanced DNS filtering (experimental)</code>: Assign unique IP per DNS request.</p></li><li><p><code>Prompt on blocklist updates</code></p></li></ul><p>Leave all the <code>Advanced</code> defaults unless you want to turn on <code>Never proxy DNS</code></p><hr><h3 id=network>Network</h3><p>Go to <code>Configure -> Network</code>:</p><ul><li><p>Set <code>Use all available networks</code> to ON. This enables Wifi and mobile data to
be used at the same time by Rethink. (Optional, may use more battery)</p></li><li><p><strong>Set your IP version</strong>: The default is <code>IPv4</code>, you can choose between
<code>IPv6 (experimental)</code> and <code>Auto (experimental)</code> if you use IPv6.</p></li><li><p>Using the <code>Loopback</code> sounds like a good idea but it makes many of the
resolvers fail.</p></li><li><p><strong>Choose fallback DNS</strong>: When your user-preferred DNS is not reachable,
fallback DNS will be used.</p></li></ul><hr><h3 id=firewall>Firewall</h3><p>Go to <code>Configure -> Firewall -> Universal firewall rules</code> and set the following
to ON:</p><ul><li><p><code>Block all apps when device is locked</code></p></li><li><p><code>Block any app not in use</code></p></li><li><p><code>Block when DNS is bypassed</code></p></li><li><p><code>Block newly installed apps by default</code></p></li><li><p><code>Block port 80 (insecure HTTP) traffic</code></p></li></ul><hr><h2 id=turn-on-dns-and-firewall>Turn ON DNS and Firewall</h2><p>Go to <code>Home</code> üè†:</p><ul><li>Click the big <code>Start</code> button on the bottom of the screen and leave it set to
the default <code>DNS and Firewall (default)</code></li></ul><p>Now that we&rsquo;ve started the DNS and Firewall, we can go back to
<code>Configure -> DNS</code> and ensure the provider we chose started successfully. You
can also experiment with different types of resolvers, make sure to wait for
below the chosen resolver to say <code>Connected</code>.</p><p>Now, all of the apps on your device have a default to allow both Wi-Fi and
mobile data access <strong>through the RethinkDNS encrypted tunnel</strong>. Try some of your
most used Apps to see if they function correctly.</p><p>RethinkDNS‚Äôs firewall blocks or restricts any network traffic that isn‚Äôt
explicitly allowed. Although by default all apps are allowed, some apps require
special permissions or bypasses due to their network behavior. Many apps rely on
multiple external services, backend APIs, etc. that may be blocked by the
firewall.</p><hr><h3 id=firefox-encrypted-dns-through-rethink>Firefox Encrypted DNS through Rethink</h3><p>First, make sure you can visit a few sites in Firefox. If you can, then your
browser traffic should be routed through the Rethink tunnel, we will check here.</p><blockquote><p>In Firefox, plug <code>about:config</code> into the URL bar and scroll down to
<code>network.ttr.mode</code> and change its value to <code>3</code>. To prevent leaking DNS queries
to the System resolver. I say scroll because when I did it, the search didn&rsquo;t
find <code>network.ttr.mode</code>.</p></blockquote><p>I use IronFox as my Android browser it&rsquo;s a Firefox fork. It&rsquo;s settings for DNS
over HTTPS are &ldquo;Default Protection&rdquo;, this enables IronFox to use RethinkDNS&rsquo;s
DNSCrypt resolver or whatever you chose. After starting Rethinks DNS and
Firewall, I opened my browser and went to <code>https://ipleaktest.com</code> to ensure the
traffic was being tunneled and it was.</p><p>For DNSCrypt with Quad9 Security, <code>dnsleaktest</code> found 5 servers all with the ISP
<code>WoodyNet</code> indicating success through Quad9. Quad9 relies on Packet Clearing
House, that&rsquo;s where the <code>WoodyNet</code> name comes from.</p><p>This has been hit or miss for me, sometimes my browser works while being routed
through Rethink and sometimes it doesn&rsquo;t, pay attention to the results of your
ipleak test. If you have to <code>Bypass DNS and Firewall</code> for your browser it makes
sense that the traffic wouldn&rsquo;t be run through Rethink so you should use the
browsers own DNS over HTTPS in that case.</p><p>I noticed that when connected to Wi-Fi, my browser works as expected but when
I&rsquo;m on mobile data it hangs and fails. Different mobile networks use different
IP routing or DNS interception which can interfere with DoH traffic from what
I&rsquo;ve gathered. In these cases I just exclude the app for the time being and
enable the built-in DNS over HTTPS that comes with Firefox.</p><hr><h3 id=apps-that-dont-work>Apps that Don&rsquo;t work</h3><p>Reddit‚Äôs app and website rely on multiple third-party services and external
domains beyond just <code>reddit.com</code> itself.</p><p>For apps that don&rsquo;t work it&rsquo;s important to ensure that your systems
<code>Private DNS</code> is set to <code>Automatic</code>.</p><p>Go to <code>Home -> Apps</code>:</p><p>Search for <code>Reddit</code>, click on it and the Firewall Rules For Reddit will pop up.
Since it is already allowed <code>Unmetered</code> and <code>Metered</code> connections and still
doesn&rsquo;t work, we can try one setting at a time until it does work and this is
the same process for other Apps that aren&rsquo;t working.</p><ul><li><p>First, you can try allowing the app to <code>Bypass DNS & Firewall</code>. Try the app
again, does it work? If not:</p></li><li><p><code>Bypass Universal</code>, this allows it to ignore any filters or blocklists as
well. If the app still doesn&rsquo;t work you can:</p></li><li><p><code>Exclude</code> the app. This makes RethinkDNS completely unaware of the app and is
often what is required for Reddit. It is my understanding that after you
<code>Exclude</code> Reddit for example, your systems Automatic Secure DNS will pick it
up.</p></li><li><p>You can also <code>Isolate</code> an App, you then have to set up <em>trust | allow</em> rules
for domains or IPs over a period of time which can take a while. You can go to
<code>Apps</code> and search for the app in question, click on it and at the bottom of
the screen you&rsquo;ll see <code>IP Logs</code>, and <code>Domain Logs</code> to help with this.</p></li><li><p>The Logs are actually pretty great as well. You can either search for the App,
click it, and at the bottom of the screen you&rsquo;ll see <code>IP Logs</code> and
<code>Domain Logs</code>. Click either to pull up said log.</p></li></ul><hr><h3 id=more-fine-grained-control>More Fine Grained Control</h3><blockquote><p>‚ùó NOTE: If you are happy with the functionality as is it is unnecessary to
follow these steps. If you already only install the minimal apps needed on
your phone (i.e. Only install what you use) you can probably just go to
individual Apps and block their networking that you are worried about such as
Facebook and Google. Routing all of your Apps through Rethink already gives
you great privacy and security benefits.</p></blockquote><p>If you read the following GrapheneOS discussion Forum, the Rethink Dev that
wrote it suggests that you:</p><p>Go to <code>Home -> Apps</code> and right under <code>Showing all apps</code> click on the grayed out
üõúüì∂ to set a rule to <strong>block both Metered and Unmetered connections to all apps
by default</strong>.</p><p>Now you will have to search for every app that you use and start by enabling
networking and then following the <code>Apps that don't work</code> section for each app
until they work as expected.</p><h3 id=resources>Resources</h3><details><summary>‚úîÔ∏è Click to Expand Resources Section</summary><div><ul><li><p><a href=https://research.cloudflare.com/projects/network-privacy/odns/>Oblivious DNS over HTTPS</a></p></li><li><p><a href=https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html>DNSCrypt Protocol</a></p></li><li><p><a href=https://orbot.app/en/>Orbot app</a></p></li><li><p>Orbot is a free app from the Guardian Project that empowers other apps on your
device to use the internet more securely. Orbot uses Tor to encrypt your
internet traffic and hide it by bouncing through a seris of computers around
the world.
&ndash;<a href=https://support.torproject.org/glossary/orbot/>TorProject Orbot</a></p></li><li><p><a href=https://guardianproject.info/apps/org.torproject.android/>Guardian Project Orbot</a></p></li><li><p>WireGuard is an extremely simple yet fast and modern VPN that utilizes
state-of-the-art cryptography. &ndash;<a href=https://www.wireguard.com/>Wireguard.com</a></p></li><li><p><a href=https://ssd.eff.org/>EFF Surveillance Self Defense</a></p></li><li><p><a href=https://www.privacyguides.org/en/dns/>PrivacyGuides DNS Recommendations</a></p></li></ul></div></details></section></main><footer id=main-footer><div class=footer><a href=#>Scroll to Top</a><div class=footer-copyright><div class=dim>¬© 2025</div><div>Made with ‚ù§Ô∏è and powered by <a href=https://github.com/math-queiroz/rusty-typewriter target=_blank>Rusty Typewriter</a> theme for <a href=https://gohugo.io/ target=_blank>Hugo</a></div></div></div></footer></div><aside id=side-pane class=side-sticky><div class=side-details><span>1846 words</span>
<span>10 - 13 minutes read</span></div><h3>Table Of Contents</h3><nav id=TableOfContents><ul><li><a href=#rethinkdns-users-guide>RethinkDNS Users Guide</a><ul><li><a href=#-key-terms>üîë Key Terms</a></li></ul></li><li><a href=#rethinkdns-overview>RethinkDNS Overview</a></li><li><a href=#getting-started>Getting Started</a><ul><li><a href=#dns>DNS</a></li><li><a href=#network>Network</a></li><li><a href=#firewall>Firewall</a></li></ul></li><li><a href=#turn-on-dns-and-firewall>Turn ON DNS and Firewall</a><ul><li><a href=#firefox-encrypted-dns-through-rethink>Firefox Encrypted DNS through Rethink</a></li><li><a href=#apps-that-dont-work>Apps that Don&rsquo;t work</a></li><li><a href=#more-fine-grained-control>More Fine Grained Control</a></li><li><a href=#resources>Resources</a></li></ul></li></ul></nav></aside></div></div></body></html>